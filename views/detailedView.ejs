<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        detailed view
    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.2.1/css/all.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.2.1/css/sharp-solid.css">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/masonry/">
    <link rel="stylesheet" href="/css/output.css">
</head>

<body class="bg-gray-900">
    <nav class="bg-gray-800 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <a href="/dashboard" class="flex-shrink-0 flex items-center">
                        <i class="text-gray-50 text-xl fa-solid fa-objects-column"></i>
                        <span class="text-gray-300 text-lg ml-2 font-semibold">Colidea</span>
                    </a>
                </div>
                <form action="/search" class="flex items-center" style="width: 40%;">
                    <input class="h-9 bg-slate-700 rounded-md my-auto w-full outline-none pl-4 text-slate-300"
                        type="search" name="query" id="searchInput" placeholder="Type here to search..." autocomplete="off" required>
                    <button id="searchButton"
                        class="px-4 h-9 py-2 bg-slate-900 rounded-md text-slate-400 text-center">search</button>
                </form>
                <div class="flex items-center">
                    <div class="hidden md:block">
                        <a href="/following-blogs"
                            class="text-gray-300 hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium">Home</a>
                        <a href="#"
                            class="text-gray-300 hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium">About</a>
                        <a href="#"
                            class="text-gray-300 hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium">Services</a>
                        <a href="/dashboard"
                            class="bg-gray-700 text-gray-300 hover:bg-gray-700 px-3 py-2 rounded-md text-sm font-medium">Dashboard</a>
                    </div>
                </div>
                <div class="flex md:hidden">
                    <button class="text-gray-300 hover:bg-gray-700 p-2 rounded-md">
                        <svg class="h-6 w-6" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>


    <div class="allPost bg-slate-700 w-4/6 mx-auto rounded-md" style="margin-top: 30px;">
        <h1 class="h-20 flex items-center justify-center text-2xl text-slate-200 font-bold">
            <%= blog.title %>
        </h1>
        <p class="px-4 py-4 text-slate-300 text-lg">
            <%= blog.content %>
        </p>
        <% if(blog.author.username === 'hdwarade') { %>
            <p class="mr-6 pb-3 text-slate-300" style="align-items: center; gap: .4rem;display: flex; justify-content: flex-end;"><%=blog.author.username%>
                <i class="text-blue-500 fa-solid fa-badge-check" style="cursor: pointer;"
                    title="Developer | Verified"></i></p>
        <% } else {%>
            <p class="mr-6 pb-3 text-slate-300" style="align-items: center; gap: .4rem;display: flex; justify-content: flex-end;"><%=blog.author.username%>
        <% } %>
    </div>
    <div class="allPost w-4/6 mx-auto rounded-md"
        style="margin-top: 30px; display: flex; justify-content: space-between; align-items: center;">
        <form action="/like/<%= blog._id %>" method="POST">
            <% if (blog.likes.includes(rootUser._id.toString())) { %>
                <!-- Show Unlike button if the user has already liked the blog -->
                <button class="text-white rounded-md py-2" type="submit">
                    <i class="fa-solid fa-thumbs-up"></i> <%= blog.likes.length %>
                </button>
            <% } else { %>
                <!-- Show Like button if the user hasn't liked the blog -->
                <button class="text-slate-300 rounded-md py-2" type="submit">
                    <i class="fa-light fa-thumbs-up"></i> <%= blog.likes.length %>
                </button>
            <% } %>
        </form>
        <button id="showCommentsButton" class="bg-blue-800 text-slate-300 rounded-md px-3 py-2">
            Show All Comments
        </button>
    </div>
    <div class="mx-auto w-4/6" style="margin-top: 20px;">
        <div id="commentsSection" style="display: block;">
            <div class="grid gap-2">
                <% blog.comments.forEach(comment=> { %>
                    <div class="bg-slate-800 rounded-md p-3">
                        <%if(comment.author === null) {%>
                            <p class="text-slate-200">No comments yet!</p>
                        <%} else {%>
                            <a href="/profile/<%= comment.author._id %>" class="text-slate-400 text-sm">@<%= comment.author.username
                                %></a>
                        <p class="text-slate-300">
                            <%= comment.text %>
                        </p>
                        <p class="float-right text-slate-600">Date: <%= comment.createdAt %>
                        </p>
                        <%}%>
                    </div>
                    <% }); %>
            </div>
        </div>
    </div>

    <script>
        const showCommentsButton = document.getElementById('showCommentsButton');
        const commentsSection = document.getElementById('commentsSection');

        showCommentsButton.addEventListener('click', () =>
        {
            commentsSection.style.display = 'block';
            showCommentsButton.style.display = 'none';
        });
    </script>

</body>

</html>